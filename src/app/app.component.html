<app-toast-container></app-toast-container>
<header class="app-navbar" [class.open]="menuOpen">
  <div class="nav-inner">
    <div class="brand" routerLink="/">
      <div class="logo">AS</div>
      <div class="meta">
        <span class="app-name">AppSis</span>
        <span class="app-sub">Gesti√≥n Comercial</span>
      </div>
    </div>
    <nav class="main-links" aria-label="Principal">
      <div class="global-search" [class.open]="searchOpen">
        <input type="text" placeholder="Buscar... (cliente, factura, producto, recibo)" [(ngModel)]="searchTerm" (input)="onSearchInput()" (keydown.escape)="clearSearch()" (focus)="openSearch()" />
        <div class="results" *ngIf="searchOpen && results && hasAnyResults()">
          <div class="section" *ngIf="results.clientes?.length">
            <div class="sec-title">Clientes</div>
            <a *ngFor="let c of results.clientes" (click)="goToCliente(c)">{{c.NombreRazonSocial}}</a>
          </div>
          <div class="section" *ngIf="results.ventas?.length">
            <div class="sec-title">Facturas</div>
            <a *ngFor="let v of results.ventas" (click)="goToVenta(v)">{{v.NumeroComp}} <span class="hint">{{v.Total | number:'1.0-0'}}</span></a>
          </div>
          <div class="section" *ngIf="results.productos?.length">
            <div class="sec-title">Productos</div>
            <a *ngFor="let p of results.productos" (click)="goToProducto(p)">{{p.Codigo || '#'+p.ProductoID}} <span class="hint">{{p.Nombre}}</span></a>
          </div>
          <div class="section" *ngIf="results.recibos?.length">
            <div class="sec-title">Recibos</div>
            <a *ngFor="let r of results.recibos" (click)="goToRecibo(r)">#{{r.ReciboID}} <span class="hint">{{ (r.Fecha||'').split(' ')[0] }}</span></a>
          </div>
          <div class="empty" *ngIf="!hasAnyResults()">Sin resultados</div>
        </div>
        <button *ngIf="searchTerm" class="clear" (click)="clearSearch()" aria-label="Limpiar b√∫squeda">√ó</button>
      </div>
      <a routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact:true}"><span>Clientes</span></a>
      <a routerLink="/notas" routerLinkActive="active"><span>Notas Pedido</span></a>
      <div class="group">
        <button type="button" class="grp-toggle" (click)="toggleSub('caja')" [class.expanded]="subOpen.caja">Caja<span class="chevron"></span></button>
        <div class="submenu" [class.show]="subOpen.caja">
          <a routerLink="/caja" routerLinkActive="active" [routerLinkActiveOptions]="{exact:true}">Resumen</a>
          <a routerLink="/caja/movimientos" routerLinkActive="active">Movimientos</a>
          <a routerLink="/caja/movimientos/new" routerLinkActive="active">Nuevo Movimiento</a>
        </div>
      </div>
      <div class="group">
        <button type="button" class="grp-toggle" (click)="toggleSub('inv')" [class.expanded]="subOpen.inv">Inventario<span class="chevron"></span></button>
        <div class="submenu" [class.show]="subOpen.inv">
          <a routerLink="/inventario" routerLinkActive="active" [routerLinkActiveOptions]="{exact:true}">Dashboard</a>
          <a routerLink="/inventario/depositos" routerLinkActive="active">Dep√≥sitos</a>
          <a routerLink="/inventario/movimientos" routerLinkActive="active">Movimientos</a>
          <a routerLink="/inventario/productos" routerLinkActive="active">Productos</a>
          <a routerLink="/inventario/productos/new" routerLinkActive="active">Nuevo Producto</a>
        </div>
      </div>
      <div class="group">
        <button type="button" class="grp-toggle" (click)="toggleSub('ventas')" [class.expanded]="subOpen.ventas">Ventas<span class="chevron"></span></button>
        <div class="submenu" [class.show]="subOpen.ventas">
          <a routerLink="/inventario/ventas" routerLinkActive="active">Facturas</a>
          <a routerLink="/inventario/recibos" routerLinkActive="active">Recibos</a>
        </div>
      </div>
      <div class="group">
        <button type="button" class="grp-toggle" (click)="toggleSub('param')" [class.expanded]="subOpen.param">Par√°metros<span class="chevron"></span></button>
        <div class="submenu" [class.show]="subOpen.param">
          <a routerLink="/inventario/parametros/banks" routerLinkActive="active">Bancos</a>
          <a routerLink="/inventario/parametros/payment-methods" routerLinkActive="active">M√©todos Pago</a>
        </div>
      </div>
    </nav>
    <div class="right-zone">
      <button class="mode-switch" (click)="toggleTheme()" [attr.aria-label]="darkMode ? 'Tema claro' : 'Tema oscuro'">
        <span *ngIf="!darkMode">üåô</span>
        <span *ngIf="darkMode">‚òÄÔ∏è</span>
      </button>
      <button class="burger" (click)="menuOpen=!menuOpen" aria-label="Men√∫" [attr.aria-expanded]="menuOpen"> <span></span><span></span><span></span></button>
    </div>
  </div>
  <div class="mobile-panel" *ngIf="menuOpen">
    <div class="mobile-links">
        <div class="mobile-search" [class.open]="searchOpen">
          <input type="text" placeholder="Buscar..." [(ngModel)]="searchTerm" (focus)="openSearch()" (input)="onSearchInput(true)" (keydown.escape)="clearSearch()" />
          <button *ngIf="searchTerm" class="clear" (click)="clearSearch()">√ó</button>
        </div>
        <div class="results mobile" *ngIf="menuOpen && searchOpen && results && hasAnyResults()">
          <div class="section" *ngIf="results.clientes?.length">
            <div class="sec-title">Clientes</div>
            <a *ngFor="let c of results.clientes" (click)="goToCliente(c)">{{c.NombreRazonSocial}}</a>
          </div>
          <div class="section" *ngIf="results.ventas?.length">
            <div class="sec-title">Facturas</div>
            <a *ngFor="let v of results.ventas" (click)="goToVenta(v)">{{v.NumeroComp}} <span class="hint">{{v.Total | number:'1.0-0'}}</span></a>
          </div>
            <div class="section" *ngIf="results.productos?.length">
              <div class="sec-title">Productos</div>
              <a *ngFor="let p of results.productos" (click)="goToProducto(p)">{{p.Codigo || '#'+p.ProductoID}} <span class="hint">{{p.Nombre}}</span></a>
            </div>
            <div class="section" *ngIf="results.recibos?.length">
              <div class="sec-title">Recibos</div>
              <a *ngFor="let r of results.recibos" (click)="goToRecibo(r)">#{{r.ReciboID}} <span class="hint">{{ (r.Fecha||'').split(' ')[0] }}</span></a>
            </div>
          <div class="empty" *ngIf="!hasAnyResults()">Sin resultados</div>
        </div>
      <a routerLink="/" routerLinkActive="active" (click)="closeMenu()" [routerLinkActiveOptions]="{exact:true}">Clientes</a>
      <a routerLink="/notas" routerLinkActive="active" (click)="closeMenu()">Notas Pedido</a>
      <div class="m-group">
        <div class="m-header" (click)="toggleSub('caja')">Caja <span class="m-chevron" [class.open]="subOpen.caja"></span></div>
        <div class="m-sub" *ngIf="subOpen.caja">
          <a routerLink="/caja" (click)="closeMenu()">Resumen</a>
          <a routerLink="/caja/movimientos" (click)="closeMenu()">Movimientos</a>
          <a routerLink="/caja/movimientos/new" (click)="closeMenu()">Nuevo Movimiento</a>
        </div>
      </div>
      <div class="m-group">
        <div class="m-header" (click)="toggleSub('inv')">Inventario <span class="m-chevron" [class.open]="subOpen.inv"></span></div>
        <div class="m-sub" *ngIf="subOpen.inv">
          <a routerLink="/inventario" routerLinkActive="active" (click)="closeMenu()">Dashboard</a>
          <a routerLink="/inventario/depositos" (click)="closeMenu()">Dep√≥sitos</a>
          <a routerLink="/inventario/movimientos" (click)="closeMenu()">Movimientos</a>
          <a routerLink="/inventario/productos" (click)="closeMenu()">Productos</a>
          <a routerLink="/inventario/productos/new" (click)="closeMenu()">Nuevo Producto</a>
        </div>
      </div>
      <div class="m-group">
        <div class="m-header" (click)="toggleSub('ventas')">Ventas <span class="m-chevron" [class.open]="subOpen.ventas"></span></div>
        <div class="m-sub" *ngIf="subOpen.ventas">
          <a routerLink="/inventario/ventas" (click)="closeMenu()">Facturas</a>
          <a routerLink="/inventario/recibos" (click)="closeMenu()">Recibos</a>
        </div>
      </div>
      <div class="m-group">
        <div class="m-header" (click)="toggleSub('param')">Par√°metros <span class="m-chevron" [class.open]="subOpen.param"></span></div>
        <div class="m-sub" *ngIf="subOpen.param">
          <a routerLink="/inventario/parametros/banks" (click)="closeMenu()">Bancos</a>
          <a routerLink="/inventario/parametros/payment-methods" (click)="closeMenu()">M√©todos Pago</a>
        </div>
      </div>
    </div>
  </div>
</header>

<main class="app-content" [class.dark]="darkMode">
  <div class="page-container">
    <router-outlet></router-outlet>
  </div>
</main>





